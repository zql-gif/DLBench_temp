SELECT CASE WHEN 0 THEN 'ERROR' ELSE 'this' END, CASE WHEN 1 THEN 'is' ELSE 'ERROR' END, CASE WHEN NULL THEN 'ERROR' ELSE 'a' END, CASE WHEN 1 THEN 2 ELSE 3 END, CASE WHEN 1 THEN 2.0 ELSE 3.0 END + 0;
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (st varchar(255) NOT NULL, u int NOT NULL);
INSERT INTO t1 VALUES ('a',1),('A',1),('aa',1),('AA',1),('a',1),('aaa',0),('BBB',0);
SELECT CASE WHEN 1 THEN st ELSE st END s FROM t1 ORDER BY s;
SELECT CASE WHEN u=1 THEN st ELSE st END s FROM t1 ORDER BY s;
ANALYZE t1;
SELECT NULLIF(u, 1) FROM t1;
EXPLAIN SELECT NULLIF(u, 1) FROM t1;
DROP TABLE t1;
CREATE TABLE t1 (num  double);
INSERT INTO t1 VALUES (144.54);
SELECT SUM(CASE WHEN num IS NULL THEN 0.00 ELSE num END) FROM t1;
DROP TABLE t1;
CREATE TABLE t1 (x int, y int);
INSERT INTO t1 VALUES (0,6),(10,16),(20,26),(30,10),(40,46),(50,56);
SELECT MIN(CASE WHEN y - x > 5 THEN y ELSE NULL END), MAX(CASE WHEN y - x > 5 THEN y ELSE NULL END) FROM t1;
DROP TABLE t1;
SELECT NULLIF(5,5) IS NULL, NULLIF(5,5) IS NOT NULL;
CREATE TABLE t1 (id int, date int DEFAULT NULL, text varchar(32) NOT NULL);
INSERT INTO t1 VALUES (1,1110000000,'Day 1'),(2,1111000000,'Day 2'),(3,1112000000,'Day 3');
SELECT id, CASE WHEN date IS NULL THEN '-' ELSE STRFTIME(TO_TIMESTAMP(date), '%d-%m-%Y') END AS date_ord, text FROM t1 ORDER BY date_ord ASC;
