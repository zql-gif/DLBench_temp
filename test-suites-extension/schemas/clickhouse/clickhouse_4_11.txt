DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (id UInt64, a UInt64, b String) ENGINE = MergeTree ORDER BY id;
INSERT INTO t1 (id, a) VALUES (1, 0), (2, 9223372036854775807), (3, 9223372036854775806), (4, 9223372036854775805);
ALTER TABLE t1 UPDATE b = toString(a) WHERE 1 = 1;
EXPLAIN SELECT 1 FROM t1 WHERE a = 9223372036854775807 AND TRIM(BOTH ' ' FROM toString(a)) = b;
EXPLAIN SELECT 1 FROM t1 WHERE a = 9223372036854775806 AND TRIM(BOTH ' ' FROM toString(a)) = b;
EXPLAIN SELECT 1 FROM t1 WHERE a = 9223372036854775805 AND TRIM(BOTH ' ' FROM toString(a)) = b;
EXPLAIN SELECT 1 FROM t1 WHERE a = 0 AND TRIM(BOTH ' ' FROM toString(a)) = b;
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (a Int64) ENGINE = MergeTree ORDER BY a;
INSERT INTO t1 VALUES (1);
SELECT * FROM t1 WHERE coalesce(toFloat64(a)) BETWEEN 0 AND 0.9;
